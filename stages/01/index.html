<!DOCTYPE html>
<html lang="zh-TW">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Stage 01</title>
    
    <!-- Libs Start -->
    <link rel="stylesheet" href="../../stylesheets/fontawesome-free-5.1.0.min.css">
    <link rel="stylesheet" href="../../stylesheets/bootstrap.min.css">
    <!-- Libs End -->

    <link rel="stylesheet" href="../../stylesheets/application.css">
</head>

<body>
    <div class="container">
        <!-- Navbar Start -->
        <div class="row">
            <div class="col-12">
                <nav class="header d-flex justify-content-between w-100">
                    <img src="../../images/logo.png" alt="國立臺灣史前文化博物館">
                    <div clsss="stages-nav">
                        <a class="stage-link" href="../01/index.html">
                            <span class="current">1</span>
                        </a>
                        <a class="stage-link" href="../02/index.html">
                            <span>2</span>
                        </a>
                        <a class="stage-link" href="../03/index.html">
                            <span>3</span>
                        </a>
                        <a class="stage-link" href="../04/index.html">
                            <span>4</span>
                        </a>
                        <a class="stage-link" href="../05/index.html">
                            <span>5</span>
                        </a>
                        <a class="stage-link" href="../06/index.html">
                            <span>6</span>
                        </a>
                        <a class="stage-link" href="../07/index.html">
                            <span>7</span>
                        </a>
                        <a class="stage-link" href="../08/index.html">
                            <span>8</span>
                        </a>
                    </div>
                </nav>
            </div>
        </div>
        <!-- Navbar End -->

        <!-- Main Content Start -->
        <div class="row no-gutters">
            <div class="col-5">
                <div class="game-container">
                    <div class="outer-box mb-3">
                        <div class="inner-box">
                           <div id="phaser-area" class="w-100 h-100"></div>
                        </div>
                    </div>
                    <div class="btn btn-custom btn-block text-center js-run-code">
                        <i class="fas fa-play"></i> 運行
                    </div>
                </div>
            </div>
            <div class="col pl-3">
                <div class="hint-container">
                    <div class="hint-icon"></div>
                    <div class="hint-content">
                        <h4>提示</h4>
                        <p>
                            走出草叢看看，鼓起勇氣和陌生人打聲招呼吧！
                        </p>
                    </div>
                </div>
                <div class="blockly-container">
                    <div class="blockly-headers row no-gutters w-100">
                        <div class="toolbox-header text-center">
                            程式積木
                        </div>
                        <div class="workspace-header col">
                            工作區
                        </div>
                    </div>
                    <xml id="blockly-toolbox" style="display: none">
                        <block type="step_forward"></block>
                        <block type="turn_x"></block>
                        <block type="say_hi"></block>
                    </xml>
                    <xml xmlns="http://www.w3.org/1999/xhtml" id="blockly-workspace" style="display:none">
                        <block deletable="false" movable="false" type="when_run" id="S)}oe#mNHcQRbK8h1Jdf" x="20" y="20"></block>
                    </xml>
                    <div id="blockly-area" class="w-100" style="height: calc(100% - 30px);"></div>
                    <div id="blockly-instance" style="position: absolute; top: 30px; left: 2px;"></div>
                </div>
            </div>
        </div>
        <!-- Main Content End -->
    </div>

    <!-- Characters Selector Modal Start -->
    <div class="modal characters-selector-modal" id="characters-selector-modal" data-backdrop="static" and data-keyboard="false" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-body">
                    <div class="d-flex h-100 w-100 flex-column">
                        <h5 class="text-center" style="color: #f49f1a;">讓我們開始吧</h3>
                        <h2 class="d-block text-center font-weight-bold my-3" style="color: #ffffff;">請先選擇要使用的角色</h2>
                        <div class="row no-gutters mx-3">
                            <div class="col-4">
                                <div class="charactor-option">
                                    <h4 class="font-weight-bold" >A</h5>
                                    <img src="../../images/child-a.png">
                                    <div class="btn btn-block btn-custom text-center js-select-character" data-dismiss="modal" data-character="child-a">
                                        選擇
                                    </div>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="charactor-option">
                                    <h4 class="text-center font-weight-bold">B</h5>
                                    <img src="../../images/child-b.png">
                                    <div class="btn btn-block btn-custom text-center js-select-character" data-dismiss="modal" data-character="child-b">
                                        選擇
                                    </div>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="charactor-option">
                                    <h4 class="text-center font-weight-bold">C</h5>
                                    <img src="../../images/child-c.png">
                                    <div class="btn btn-block btn-custom text-center js-select-character" data-dismiss="modal" data-character="child-c">
                                        選擇
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Characters Selector Modal End -->

    <!-- Chat Modal Start -->
    <div class="modal chat-modal" id="chat-modal" data-backdrop="static" and data-keyboard="false" tabindex="-1" role="dialog">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-body">
              <div class="chat-container h-100 mx-auto">
                  <div class="scene" style="background-image: url('../../images/chat-01.png');"></div>
                  <div class="chat-content"></div>
              </div>
            </div>
          </div>
        </div>
    </div>
    <!-- Chat Modal End -->

    <!-- Libs Start -->
    <script src="../../javascripts/promise.polyfill.min.js"></script>
    <script src="../../javascripts/jquery-3.3.1.min.js"></script>
    <script src="../../javascripts/bootstrap.bundle-4.1.1.min.js"></script>
    <script src="../../javascripts/phaser-2.11.0.min.js"></script>
    <script src="../../javascripts/blockly_compressed.js"></script>
    <script src="../../javascripts/blocks_compressed.js"></script>
    <script src="../../javascripts/javascript_compressed.js"></script>
    <script src="../../javascripts/blockly_msg_zh_hant.js"></script>
    <!-- Libs End -->

    <script src="../../javascripts/custom_blocks.js"></script>
    <script src="../../javascripts/application.js"></script>
    <script src="./index.js"></script>

    <script>
        $('.js-select-character').on('click', function() {
            var character = $(this).data('character');
            localStorage.setItem('selectedCharacter', character);
        });

        $('#characters-selector-modal').on('hidden.bs.modal', function (e) {
            GAME.init();
            var scenes = [
                { actor: '現代人', sentence: '好暈... 這裡是哪裡阿？(自言自語)', action: function() {} },
                { actor: '史前人', sentence: '什麼聲音？誰在那裏？', action: function() {} },
                { actor: '現代人', sentence: '......', action: function() {} },
                { actor: '史前人', sentence: '別躲在那邊不說話，你是誰？', action: function() {} },
            ];
            
            window.startChat(scenes);
        });

        $('#characters-selector-modal').modal('show');
    </script>
</body>
</html>